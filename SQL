-- SQL code

What is the relationship between environment satisfaction and job satisfaction across employees
SELECT 
    EnvironmentSatisfaction, 
    JobSatisfaction, 
    COUNT(*) AS EmployeeTotal,
    CAST(ROUND(COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (), 2) AS float) AS Percentage,
    CAST(ROUND(SUM(CASE WHEN Attrition = 'Yes' THEN 1 ELSE 0 END) * 100.0 / COUNT(*), 2) AS float) AS AttritionRate
FROM Employees e 
JOIN Responses r 
ON e.EmployeeNumber = r.EmployeeNumber
GROUP BY EnvironmentSatisfaction, JobSatisfaction
ORDER BY AttritionRate, EnvironmentSatisfaction, JobSatisfaction ASC;
